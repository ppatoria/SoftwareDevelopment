<!doctype html>
<html lang="en">
  
<!-- Mirrored from isocpp.org/wiki/faq/mixing-c-and-cpp by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 01 Aug 2015 12:41:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <title>
            Standard C++
    </title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="../../favicon.ico" rel="shortcut icon" />
    <link rel="apple-touch-icon" href="apple-touch-icon-57.html" />
    <link rel="apple-touch-icon" sizes="72x72" href="apple-touch-icon-72.html" />
    <link rel="apple-touch-icon" sizes="114x114" href="apple-touch-icon-114.html" />
    <link rel="apple-touch-icon" sizes="144x144" href="apple-touch-icon-144.html" />
    
    <link href="../../indexe9db.html?css=stylesheets/prettify" rel="stylesheet" media="all" type="text/css" />
    <script type="text/javascript" src="../../../cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
    
    <link href="../../index6bd3.html?css=stylesheets/screen" rel="stylesheet" media="all" type="text/css" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <script src="../../mint/index3298.html?js" type="text/javascript"></script>
    
    <script type="text/javascript" src="../../../use.typekit.com/kml7swa.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
    
  </head>
  
  <body class="hide-sidebar">
    <div id="root">
    
      <div id="crown">
        <a id="sidebar-toggle" href="#sidebar">Show sidebar &raquo;</a>
        <ul class="user">
                          <li><a href="../../member/login.html">Sign In</a></li>
          <li><a href="../../member/register.html">Register</a></li>
                </ul>
      </div>

      <header id="top" role="banner">
        <div class="container">
          <h1>
            <a href="../../index.html"><img src="../../images/uploads/logo-sun.jpg" alt="Standard C++" /></a>
          </h1>
          <nav role="navigation">
            <ul id="nav-sub">
<li class="first"><a href="../../get-started.html">Get Started!</a></li>
<li><a href="../../tour.html">Tour</a></li>
<li><a href="../../faq.html">C++ Super-FAQ</a></li>
<li><a href="../../blog.html">Blog</a></li>
<li><a href="../../forums.html">Forums</a></li>
<li><a href="../../std.html">Standardization</a></li>
<li class="last"><a href="../../about.html">About</a></li>
</ul>
          </nav>
          <form action="https://isocpp.org/search/google">
            <input type="text" name="q" id="q" maxlength="100" value="" class="textbox" />
            <input type="submit" value="Search" class="button" />
          </form>
          <!--
          <form method="post" action="https://isocpp.org/"  >
<div class='hiddenFields'>
<input type="hidden" name="ACT" value="6" />
<input type="hidden" name="XID" value="4b95c29c052f3fda7c8d5fadc5c3e1e9ec1f8f41" />
<input type="hidden" name="RES" value="" />
<input type="hidden" name="meta" value="zYMKgX58Zs8+1aclN9tC7heLzqeMS/BIDf2KWaqfUPy9IuEVYHdFD1dlGh34VWoTLfYfqx2VVNOeAsrIgIvvoFDyH5RKx1rRrjSIJmrlV4WTNhwE+/Onu3ISLsbzAk2awqSU6A+hVvt+f/zJn30d7+qnYdsX9iFLWu40TELdyhIN7OvZg7LuJknFB0gZ7nQTklJ/9coWuk9SURbQpuERR2hTSI2C5xLtlwfiI61PqkKwyrlOKG6XDMBSEtvAIHOCp+adyiqHkYhNSPC8wgrdUEXu/O1ACVY3yqa/hYv3qY5COcgp3UflhKiNqQvGfAikDLrb28Jq5FJxzSTO4kcq1kRWnkMAIa+DJDX1Ri9lxnSoesPEDjJwSIcqjcXXIxh1l0qg2xNSdmuOrE+KB+C8x3zG6M/Rmrrfc9CHMGWIs3c=" />
<input type="hidden" name="site_id" value="1" />
</div>


            <input type="text" name="keywords" id="keywords" maxlength="100" value="M50o93H7pQ09L8X1t49cHY01Z5j4TT91fGfr" class="textbox" />
            <input type="submit" value="Search" class="button" />
          </form>
          -->
        </div>
      </header>

      <div id="content" class="hide-sidebar" role="main">
        <div class="container">
    
      <div id="sidebar">
              <section>
              <header>Features</header>
            <div class="sidebar-section-content prettify">
        <p style="text-align: center;">
	&nbsp;</p>
<p>
	<a href="https://github.com/cplusplus/draft"><img alt="" src="../../images/uploads/github.png" style="width: 90px; height: 48px; margin-right: 5px; margin-left: 5px; float: right;" /></a><a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2015/n4527.pdf"><strong>Working Draft</strong> of the next&nbsp;standard</a></p>
<p>
	&nbsp;</p>
<p>
	<a href="../../std/status.html">Current ISO C++ status</a></p>
<p>
	&nbsp;</p>
<p>
	<a href="../../std/meetings-and-participation/upcoming-meetings.html">Upcoming ISO C++ meetings</a></p>
<p>
	&nbsp;</p>
<p>
	<a href="http://en.cppreference.com/w/cpp/compiler_support">Compiler conformance status</a></p>
      </div>
    </section>
  
  
  
        <nav>
          <section>
            <header>
              Navigation
            </header>
            <ul>
              <li><a href="../faq.html">FAQ Home</a></li>
              <li><a href="../../themes/wiki_themes/isocpp/rss/faq-revisions-rss.php" class="icon rss">FAQ RSS Feed</a></li>
              <li><a href="editinfo.html">FAQ Help</a></li>
                          </ul>
          </section>
        
        
          <section>
            <header>
              Search this Wiki
            </header>
            <form method="post" action="https://isocpp.org/wiki/faq/Special:Search_results">
              <input type="hidden" name="XID" value="eb794cfaca4f4e1f8683b902a1890bee7f1bcb44" />
              <input type="text" class="input" name="keywords" size="20" value="" maxlength="80" /><input type="submit" class="submit" value="Go" />
            </form>
          </section>
          
          <section>
            <header>
              Go to Page
            </header>
            <form method="post" action="https://isocpp.org/wiki/faq/Special:Find_page">
              <input type="hidden" name="XID" value="a7712206415fa0e1707c4c63c1dbce974942dbd0" />
              <input type="text" class="input" name="title" size="20" value="" maxlength="80" /><input type="submit" class="submit" value="Go" />
            </form>
          </section>
        </nav>
          
      <section>
              <header>Upcoming Events</header>
            <div class="sidebar-section-content prettify">
        <p>
	<a href="http://cppcon.org/" style="line-height: 1;"><strong>CppCon 2015</strong></a></p>
<p>
	<span style="line-height: 1;">Sep 19-20 (boot camp)</span></p>
<p>
	<span style="line-height: 1;">Sep 20-25 (conference)</span></p>
<p>
	<span style="line-height: 1;">Bellevue, WA, USA</span></p>
<p>
	&nbsp;</p>
<p>
	<span style="line-height: 1;"><a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2015/n4544.htm"><strong>ISO C++ Fall Meeting</strong></a> <a href="../../files/papers/n4545.html">(agenda)</a></span></p>
<p>
	Oct 19-24,&nbsp;<span style="line-height: 1;">Kona, HI, USA</span></p>
<p>
	&nbsp;</p>
<p>
	<a href="http://meetingcpp.com/index.php/meetingcpp-2015.html"><strong>Meeting C++ 2015</strong></a></p>
<p>
	Dec 4-5, Berlin, Germany</p>
<p>
	&nbsp;</p>
      </div>
    </section>
  
      <section>
            <div class="sidebar-section-content prettify">
        <div class="twitter-container">
	<a class="twitter-timeline" data-dnt="true" data-widget-id="344512921423998976" href="https://twitter.com/isocpp">Tweets by @isocpp</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></div>
      </div>
    </section>
  
      </div>

      <div id="mainbar">
        <header>
          <div class="breadcrumbs">

            <a href="../faq.html">Wiki Home</a>
            <span class="breadcrumbspacer">&nbsp;&nbsp;&gt;&nbsp;&nbsp;</span>

                        mixing c and cpp
            
          </div>
          
          <div class="wiki-page-actions">
                    <a href="mixing-c-and-cpp.html">View</a>
                              </div>
          
          <h2>
                    
          
                    
                    mixing c and cpp
                    </h2>

          <div class="save-to-reader wiki">
            <div class="title">Save to:</div>
            <a href="http://www.instapaper.com/hello2?url={url}&amp;title=mixing%20c%20and%20cpp" class="icon instapaper">Instapaper</a>
            <a href="http://getpocket.com/create?url={url}&amp;action=save&amp;k=3aNp2F20Aao4bvW884g224eUfud1nfI0" class="icon pocket">Pocket</a>
            <a href="#" class="icon readability">Readability</a>
            <div class="rdbWrapper" data-show-read="1" data-show-send-to-kindle="1" data-show-print="1" data-show-email="1" data-orientation="0" data-version="1" data-bg-color="#ffffff"></div><script type="text/javascript">(function() {var s = document.getElementsByTagName("script")[0],rdb = document.createElement("script"); rdb.type = "text/javascript"; rdb.async = true; rdb.src = document.location.protocol + "//www.readability.com/embed.js"; s.parentNode.insertBefore(rdb, s); })();</script>
          </div>
          
        </header>

        <article>

          <!-- Begin Main Content of Page -->

          
          

          <div id="wiki-content">

          

          <div class="prettify">


<h2 id="mixing-c-and-cpp">How to mix C and C++</h2>

<h3 id="overview-mixing-langs">What do I need to know when mixing C and C++ code?</h3>

<p>Here are some high points (though some compiler-vendors might not require all these; check with your compiler-vendor&#8217;s
documentation):</p>

<ul>
<li>You must use your C++ compiler when compiling <code>main()</code> (e.g., for static initialization)</li>
<li>Your C++ compiler should direct the linking process (e.g., so it can get its special libraries)</li>
<li>Your C and C++ compilers probably need to come from the same vendor and have compatible versions (e.g., so they
have the same calling conventions)</li>
</ul>

<p>In addition, you&#8217;ll need to read the rest of this section to find out how to make your C functions callable by C++
and/or your C++ functions callable by C.</p>

<p>BTW there is another way to handle this whole thing: compile all your code (even your C-style code) using a C++
compiler. That pretty much eliminates the need to mix C and C++, plus it will cause you to be more careful (and
possibly &#8212;hopefully!&#8212; discover some bugs) in your C-style code. The down-side is that you&#8217;ll need to update your
C-style code in certain ways, basically because <a href="big-picture.html#back-compat-with-c" title="FAQ: Is C++ backward compatible with ANSI/ISO C?">the C++ compiler is more careful/picky than your C
compiler</a>. The point is that the effort required to clean up your C-style code may be less than the
effort required to mix C and C++, and as a bonus you get cleaned up C-style code. Obviously you don&#8217;t have much of a
choice if you&#8217;re not able to alter your C-style code (e.g., if it&#8217;s from a third-party).</p>

<h3 id="call-c">How do I call a C function from C++?</h3>

<p>Just declare the C function <code>extern "C"</code> (in your C++ code) and call it (from your C or C++ code). For example:</p>

<pre><code>    // C++ code

    extern "C" void f(int); // one way

    extern "C" {    // another way
        int g(double);
        double h();
    };

    void code(int i, double d)
    {
        f(i);
        int ii = g(d);
        double dd = h();
        // ...
    }
</code></pre>

<p>The definitions of the functions may look like this:</p>

<pre><code>    /* C code: */

    void f(int i)
    {
        /* ... */
    }

    int g(double d)
    {
        /* ... */
    }

    double h()
    {
        /* ... */
    }
</code></pre>

<p>Note that C++ type rules, not C rules, are used. So you can&#8217;t call function declared <code>extern "C"</code> with the wrong number of arguments. For example:</p>

<pre><code>    // C++ code

    void more_code(int i, double d)
    {
        double dd = h(i,d); // error: unexpected arguments
        // ...
    }
</code></pre>

<h3 id="call-cpp">How do I call a C++ function from C?</h3>

<p>Just declare the C++ function <code>extern "C"</code> (in your C++ code) and call it (from your C or C++ code). For example:</p>

<pre><code>    // C++ code:

    extern "C" void f(int);

    void f(int i)
    {
        // ...
    }
</code></pre>

<p>Now <code>f()</code> can be used like this:</p>

<pre><code>    /* C code: */

    void f(int);

    void cc(int i)
    {
        f(i);
        /* ... */
    }
</code></pre>

<p>Naturally, this works only for non-member functions. If you want to call member functions (incl. virtual functions) from C, you need to provide a simple wrapper. For example:</p>

<pre><code>    // C++ code:

    class C {
        // ...
        virtual double f(int);
    };

    extern "C" double call_C_f(C* p, int i) // wrapper function
    {
        return p-&gt;f(i);
    }
</code></pre>

<p>Now <code>C::f()</code> can be used like this:</p>

<pre><code>    /* C code: */

    double call_C_f(struct C* p, int i);

    void ccc(struct C* p, int i)
    {
        double d = call_C_f(p,i);
        /* ... */
    }
</code></pre>

<p>If you want to call overloaded functions from C, you must provide wrappers with distinct names for the C code to use. For example:</p>

<pre><code>    // C++ code:

    void f(int);
    void f(double);

    extern "C" void f_i(int i) { f(i); }
    extern "C" void f_d(double d) { f(d); }
</code></pre>

<p>Now the <code>f()</code> functions can be used like this:</p>

<pre><code>    /* C code: */

    void f_i(int);
    void f_d(double);

    void cccc(int i,double d)
    {
        f_i(i);
        f_d(d);
        /* ... */
    }
</code></pre>

<p>Note that these techniques can be used to call a C++ library from C code even if you cannot (or do not want to) modify the C++ headers.</p>

<h3 id="include-c-hdrs-system">How can I include a standard C header file in my C++ code?</h3>

<p>To <code>#include</code> a standard header file (such as <code>&lt;cstdio&gt;</code>), you don&#8217;t have to do anything unusual. E.g.,</p>

<pre><code>// This is C++ code

#include &lt;cstdio&gt;                // Nothing unusual in #include line

int main()
{
  std::printf("Hello world\n");  // Nothing unusual in the call either
  // ...
}
</code></pre>

<p>If you think the <code>std::</code> part of the <code>std::printf()</code> call is unusual, then the best thing to do is &#8220;get over it.&#8221; In
other words, it&#8217;s the standard way to use names in the standard library, so you might as well start getting used to it
now.</p>

<p>However if you are compiling C code using your C++ compiler, you don&#8217;t want to have to tweak all these calls from
<code>printf()</code> to <code>std::printf()</code>. Fortunately in this case the C code will use the old-style header <code>&lt;stdio.h&gt;</code> rather
than the new-style header <code>&lt;cstdio&gt;</code>, and the magic of namespaces will take care of everything else:</p>

<pre><code>/* This is C code that I'm compiling using a C++ compiler */

#include &lt;stdio.h&gt;          /* Nothing unusual in #include line */

int main()
{
  printf("Hello world\n");  /* Nothing unusual in the call either */
  // ...
}
</code></pre>

<p>Final comment: if you have C headers that are <em>not</em> part of the standard library, we have somewhat different guidelines
for you. There are two cases: either you <a href="mixing-c-and-cpp.html#include-c-hdrs-nonsystem" title="FAQ: How can I include a non-system C header file in my C++ code?"><em>can&#8217;t</em> change the header</a>, or you <a href="mixing-c-and-cpp.html#include-c-hdrs-personal" title="FAQ: How can I modify my own C header files so it's easier to #include them in C++ code?"><em>can</em> change
the header</a>.</p>

<h3 id="include-c-hdrs-nonsystem">How can I include a non-system C header file in my C++ code?</h3>

<p>If you are including a C header file that isn&#8217;t provided by the system, you may need to wrap the <code>#include</code> line in an
<code>extern "C" { /*...*/ }</code> construct. This tells the C++ compiler that the functions declared in the header file are C
functions.</p>

<pre><code>// This is C++ code

extern "C" {
  // Get declaration for f(int i, char c, float x)
  #include "my-C-code.h"
}

int main()
{
  f(7, 'x', 3.14);   // Note: nothing unusual in the call
  // ...
}
</code></pre>

<p>Note: Somewhat different guidelines apply for <a href="mixing-c-and-cpp.html#include-c-hdrs-system" title="FAQ: How can I include a standard C header file in my C++ code?">C headers provided by the system (such as
<code>&lt;cstdio&gt;</code>)</a> and for <a href="mixing-c-and-cpp.html#include-c-hdrs-personal" title="FAQ: How can I modify my own C header files so it's easier to #include them in C++ code?">C headers that you can change</a>.</p>

<h3 id="include-c-hdrs-personal">How can I modify my own C header files so it&#8217;s easier to <code>#include</code> them in C++ code?</h3>

<p>If you are including a C header file that isn&#8217;t provided by the system, and if you are able to change the C header, you
should strongly consider adding the <code>extern "C" {...}</code> logic inside the header to make it easier for C++ users to
<code>#include</code> it into their C++ code. Since a C compiler won&#8217;t understand the <code>extern "C"</code> construct, you must wrap the
<code>extern "C" {</code> and <code>}</code> lines in an <code>#ifdef</code> so they won&#8217;t be seen by normal C compilers.</p>

<p>Step #1: Put the following lines at the very top of your C header file (note: the symbol <code>__cplusplus</code> is <code>#define</code>d
if/only-if the compiler is a C++ compiler):</p>

<pre><code>#ifdef __cplusplus
extern "C" {
#endif
</code></pre>

<p>Step #2: Put the following lines at the very bottom of your C header file:</p>

<pre><code>#ifdef __cplusplus
}
#endif
</code></pre>

<p>Now you can <code>#include</code> your C header without any <code>extern "C"</code> nonsense in your C++ code:</p>

<pre><code>// This is C++ code

// Get declaration for f(int i, char c, float x)
#include "my-C-code.h"   // Note: nothing unusual in #include line

int main()
{
  f(7, 'x', 3.14);       // Note: nothing unusual in the call
  // ...
}
</code></pre>

<p>Note: Somewhat different guidelines apply for <a href="mixing-c-and-cpp.html#include-c-hdrs-system" title="FAQ: How can I include a standard C header file in my C++ code?">C headers provided by the system (such as
<code>&lt;cstdio&gt;</code>)</a> and for <a href="mixing-c-and-cpp.html#include-c-hdrs-nonsystem" title="FAQ: How can I include a non-system C header file in my C++ code?">C headers that you can&#8217;t change</a>.</p>

<p>Note: <code>#define</code> macros are <a href="big-picture.html#defn-evil" title="FAQ: What does the FAQ mean by 'such and such is evil'?">evil</a> in 4 different ways: <a href="inline-functions.html#inline-vs-macros" title="FAQ: Why should I use inline functions instead of plain old #define macros?">evil#1</a>,
<a href="misc-technical-issues.html#macros-with-if" title="FAQ: What should be done with macros that contain if?">evil#2</a>, <a href="misc-technical-issues.html#macros-with-multi-stmts" title="FAQ: What should be done with macros that have multiple lines?">evil#3</a>, and <a href="misc-technical-issues.html#macros-with-token-pasting" title="FAQ: What should be done with macros that need to paste two tokens together?">evil#4</a>. But they&#8217;re still
<a href="big-picture.html#use-evil-things-sometimes" title="FAQ: Will I sometimes use any so-called 'evil' constructs?">useful sometimes</a>. Just wash your hands after using them.</p>

<h3 id="cpp-calls-c">How can I call a non-system C function <code>f(int,char,float)</code> from my C++ code?</h3>

<p>If you have an individual C function that you want to call, and for some reason you don&#8217;t have or don&#8217;t want to
<code>#include</code> a C header file in which that function is declared, you can declare the individual C function in your C++
code using the <code>extern "C"</code> syntax. Naturally you need to use the full function prototype:</p>

<pre><code>extern "C" void f(int i, char c, float x);
</code></pre>

<p>A block of several C functions can be grouped via braces:</p>

<pre><code>extern "C" {
  void   f(int i, char c, float x);
  int    g(char* s, const char* s2);
  double sqrtOfSumOfSquares(double a, double b);
}
</code></pre>

<p>After this you simply call the function just as if it were a C++ function:</p>

<pre><code>int main()
{
  f(7, 'x', 3.14);   // Note: nothing unusual in the call
  // ...
}
</code></pre>

<h3 id="c-calls-cpp">How can I create a C++ function <code>f(int,char,float)</code> that is callable by my C code?</h3>

<p>The C++ compiler must know that <code>f(int,char,float)</code> is to be called by a C compiler using the <a href="mixing-c-and-cpp.html#include-c-hdrs-nonsystem" title="FAQ: How can I include a non-system C header file in my C++ code?"><code>extern "C"</code>
construct</a>:</p>

<pre><code>// This is C++ code

// Declare f(int,char,float) using extern "C":
extern "C" void f(int i, char c, float x);

// ...

// Define f(int,char,float) in some C++ module:
void f(int i, char c, float x)
{
  // ...
}
</code></pre>

<p>The <code>extern "C"</code> line tells the compiler that the external information sent to the linker should use C calling
conventions and name mangling (e.g., preceded by a single underscore). Since name overloading isn&#8217;t supported by C, you
can&#8217;t make several overloaded functions simultaneously callable by a C program.</p>

<h3 id="link-errs-mixed-langs">Why is the linker giving errors for C/C++ functions being called from C++/C functions?</h3>

<p>If you didn&#8217;t get your <code>extern "C"</code> right, you&#8217;ll sometimes get linker errors rather than compiler errors. This is due
to the fact that C++ compilers usually &#8220;mangle&#8221; function names (e.g., to support function overloading) differently
than C compilers.</p>

<p>See the previous two FAQs on how to use <code>extern "C"</code>.</p>

<h3 id="cpp-objs-passed-to-c">How can I pass an object of a C++ <code>class</code> to/from a C function?</h3>

<p>Here&#8217;s an example (for info on <code>extern "C"</code>, see the previous two FAQs).</p>

<p><code>Fred.h</code>:</p>

<pre><code>/* This header can be read by both C and C++ compilers */
#ifndef FRED_H
#define FRED_H

#ifdef __cplusplus
  class Fred {
  public:
    Fred();
    void wilma(int);
  private:
    int a_;
  };
#else
  typedef
    struct Fred
      Fred;
#endif

#ifdef __cplusplus
extern "C" {
#endif

#if defined(__STDC__) || defined(__cplusplus)
  extern void c_function(Fred*);   /* ANSI C prototypes */
  extern Fred* cplusplus_callback_function(Fred*);
#else
  extern void c_function();        /* K&amp;R style */
  extern Fred* cplusplus_callback_function();
#endif

#ifdef __cplusplus
}
#endif

#endif /*FRED_H*/
</code></pre>

<p><code>Fred.cpp</code>:</p>

<pre><code>// This is C++ code

#include "Fred.h"

Fred::Fred() : a_(0) { }

void Fred::wilma(int a) { }

Fred* cplusplus_callback_function(Fred* fred)
{
  fred-&gt;wilma(123);
  return fred;
}
</code></pre>

<p><code>main.cpp</code>:</p>

<pre><code>// This is C++ code

#include "Fred.h"

int main()
{
  Fred fred;
  c_function(&amp;fred);
  // ...
}
</code></pre>

<p><code>c-function.c</code>:</p>

<pre><code>/* This is C code */

#include "Fred.h"

void c_function(Fred* fred)
{
  cplusplus_callback_function(fred);
}
</code></pre>

<p>Unlike your C++ code, your C code will not be able to tell that two pointers point at the same object unless the
pointers are <em>exactly</em> the same type. For example, in C++ it is easy to check if a <code>Derived*</code> called <code>dp</code> points to
the same object as is pointed to by a <code>Base*</code> called <code>bp</code>: just say <code>if (dp == bp) ...</code>. The C++ compiler
automatically converts both pointers to the same type, in this case to <code>Base*</code>, then compares them. Depending on the
C++ compiler&#8217;s implementation details, this conversion sometimes changes the bits of a pointer&#8217;s value.</p>

<p>(Technical aside: Most C++ compilers use a binary object layout that causes this conversion to happen with <a href="multiple-inheritance.html" title="Section: Inheritance — Multiple and Virtual Inheritance">multiple
inheritance</a> and/or <a href="multiple-inheritance.html#virtual-inheritance-abcs" title="FAQ: What special considerations do I need to know about when I use virtual inheritance?">virtual inheritance</a>. However the C++ language
does not impose that object layout so in principle a conversion could also happen even with non-virtual single
inheritance.)</p>

<p>The point is simple: your C compiler will not know how to do that pointer conversion, so the conversion from <code>Derived*</code>
to <code>Base*</code>, for example, must take place in code compiled with a C++ compiler, not in code compiled with a C compiler.</p>

<p><em>NOTE:</em> you must be especially careful when converting both to <code>void*</code> since that conversion will not allow either the
C or C++ compiler to do the proper pointer adjustments! The comparison <code>(x == y)</code> might be <code>false</code> even if <code>(b == d)</code>
is <code>true</code>:</p>

<pre><code>void f(Base* b, Derived* d)
{
  if (b == d) {   ☺ Validly compares a Base* to a Derived*
    // ...
  }

  void* x = b;
  void* y = d;
  if (x == y) {   ☹ BAD FORM! DO NOT DO THIS!
    // ...
  }
}
</code></pre>

<p>As stated above, the above pointer conversions will typically happen with multiple and/or virtual inheritance, but
<em>please</em> do <em>not</em> look at that as an exhaustive list of the <em>only</em> times when the pointer conversions will happen.</p>

<p>You have been warned.</p>

<p>If you really want to use <code>void*</code> pointers, here is the safe way to do it:</p>

<pre><code>void f(Base* b, Derived* d)
{
  void* x = b;
  void* y = static_cast&lt;Base*&gt;(d);  // If conversion is needed, it will happen in the static_cast&lt;&gt;
  if (x == y) {   // ☺ Validly compares a Base* to a Derived*
    // ...
  }
}
</code></pre>

<h3 id="get-cpp-data-members-from-c">Can my C function directly access data in an object of a C++ <code>class</code>?</h3>

<p>Sometimes.</p>

<p>(For basic info on passing C++ objects to/from C functions, read the previous FAQ).</p>

<p>You can safely access a C++ object&#8217;s data from a C function if the C++ class:</p>

<ul>
<li>Has no <a href="virtual-functions.html" title="Section: Inheritance — virtual functions"><code>virtual</code></a> functions (including inherited <code>virtual</code> functions)</li>
<li>Has all its data in the same access-level section (private/protected/public)</li>
<li>Has no fully-contained subobjects with <a href="virtual-functions.html" title="Section: Inheritance — virtual functions"><code>virtual</code></a> functions</li>
</ul>

<p>If the C++ class has any base classes at all (or if any fully contained subobjects have base classes), accessing the
data will <em>technically</em> be non-portable, since <code>class</code> layout under inheritance isn&#8217;t imposed by the language. However
in practice, all C++ compilers do it the same way: the base class object appears first (in left-to-right order in
the event of multiple inheritance), and member objects follow.</p>

<p>Furthermore, if the class (or any base class) contains any <code>virtual</code> functions, almost all C++ compliers put a <code>void*</code>
into the object either at the location of the first <code>virtual</code> function or at the very beginning of the object. Again,
this is not required by the language, but it is the way &#8220;everyone&#8221; does it.</p>

<p>If the class has any <code>virtual</code> base classes, it is even more complicated and less portable. One common implementation
technique is for objects to contain an object of the <code>virtual</code> base class (<code>V</code>) last (regardless of where <code>V</code> shows up
as a <code>virtual</code> base class in the inheritance hierarchy). The rest of the object&#8217;s parts appear in the normal order.
Every derived class that has <code>V</code> as a <code>virtual</code> base class actually has a <em>pointer</em> to the <code>V</code> part of the final object.</p>

<h3 id="cpp-higher-than-c">Why do I feel like I&#8217;m &#8220;further from the machine&#8221; in C++ as opposed to C?</h3>

<p>Because you are.</p>

<p>As an OO programming language, C++ allows you to model the problem domain itself, which allows you to program in the
language of the problem domain rather than in the language of the solution domain.</p>

<p>One of C&#8217;s great strengths is the fact that it has &#8220;no hidden mechanism&#8221;: what you see is what you get. You can read a
C program and &#8220;see&#8221; every clock cycle. This is not the case in C++; old line C programmers (such as many of us once
were) are often ambivalent (can you say, &#8220;hostile&#8221;?) about this feature. However after they&#8217;ve made the transition to OO
thinking, they often realize that although C++ hides some mechanism from the programmer, it also provides a level of
abstraction and economy of expression which lowers maintenance costs without destroying run-time performance.</p>

<p>Naturally you can write bad code in any language; C++ doesn&#8217;t guarantee any particular level of quality, reusability,
abstraction, or any other measure of &#8220;goodness.&#8221;</p>

<p><em>C++ doesn&#8217;t try to make it impossible for bad programmers to write bad programs; it enables reasonable developers to
create superior software.</em></p>

<!--
File: id-defns

Defines IDs for each FAQ and section.

Rule:
  FAQ editors should always use these IDs for every internal cross-reference within the FAQ.
  Always use indirect links ('[description][id-of-target]')  when linking to the FAQ from within the FAQ.
  Never  use  direct  links ('[description](url-of-target)') when linking to the FAQ from within the FAQ.

Reason:
  The FAQ is a living document -- we will split/join sections and move FAQs between sections.
  Those changes result in changes to the URL of the moved FAQs, which breaks all direct links -- many changes.
  However using indirect links means we need only change one thing in one place: this id-defns file.

Caveat:
  This rule applies only to internal cross-reference links, not to links to resources outside the FAQ.
  E.g., if you are making a link from FAQ 'x' to FAQ 'y', then you should always use FAQ 'y's link-ID.
  However if you are making a link from FAQ 'x' to some resource outside the FAQ, you have two choices:
  You can use a direct link to the external resource's URL ('[description](url-of-external-resource)'),
  or you can add the external resource to this file then link indirectly ('[description][id-of-external-resource]').
  Typically you would do the latter only when the FAQ contains more than one link to that external resource.
-->

<p><!-- special resources -->
<!-- /wiki/faq/index = 'C++ FAQ' -->
<!-- /wiki/faq/big-picture = 'Big Picture Issues' -->
<!-- /wiki/faq/classes-and-objects = 'Classes and Objects' -->
<!-- /wiki/faq/references = 'References' -->
<!-- /wiki/faq/inline-functions = 'Inline Functions' -->
<!-- /wiki/faq/ctors = 'Constructors' -->
<!-- /wiki/faq/dtors = 'Destructors' -->
<!-- /wiki/faq/assignment-operators = 'Assignment Operators' -->
<!-- /wiki/faq/operator-overloading = 'Operator Overloading' -->
<!-- /wiki/faq/friends = 'Friends' -->
<!-- /wiki/faq/input-output = 'Input/output via <iostream> and <cstdio>' -->
<!-- /wiki/faq/freestore-mgmt = 'Memory Management' -->
<!-- /wiki/faq/exceptions = 'Exceptions and Error Handling' -->
<!-- /wiki/faq/const-correctness = 'Const Correctness' -->
<!-- /wiki/faq/big3 = 'The Big Three' -->
<!-- /wiki/faq/basics-of-inheritance = 'Inheritance — Basics' -->
<!-- /wiki/faq/virtual-functions = 'Inheritance — virtual functions' -->
<!-- /wiki/faq/proper-inheritance = 'Inheritance — Proper Inheritance and Substitutability' -->
<!-- /wiki/faq/abcs = 'Inheritance — Abstract Base Classes (ABCs)' -->
<!-- /wiki/faq/strange-inheritance = 'Inheritance — What your mother never told you' -->
<!-- /wiki/faq/private-inheritance = 'Inheritance — private and protected inheritance' -->
<!-- /wiki/faq/multiple-inheritance = 'Inheritance — Multiple and Virtual Inheritance' -->
<!-- /wiki/faq/intrinsic-types = 'Built-in / Intrinsic / Primitive Data Types' -->
<!-- /wiki/faq/coding-standards = 'Coding Standards' -->
<!-- /wiki/faq/how-to-learn-cpp = 'Learning C++' -->
<!-- /wiki/faq/newbie = 'Newbie Questions & Answers' -->
<!-- /wiki/faq/objective-c = 'Learning C++ if you already know Objective-C' -->
<!-- /wiki/faq/c = 'Learning C++ if you already know C' -->
<!-- /wiki/faq/csharp-java = 'Learning C++ if you already know C# or Java' -->
<!-- /wiki/faq/myths = 'Myths and Urban Legends About C++' -->
<!-- /wiki/faq/value-vs-ref-semantics = 'Reference and Value Semantics' -->
<!-- /wiki/faq/mixing-c-and-cpp = 'How to mix C and C++' -->
<!-- /wiki/faq/pointers-to-members = 'Pointers to Member Functions' -->
<!-- /wiki/faq/containers = 'Container Classes' -->
<!-- /wiki/faq/templates = 'Templates' -->
<!-- /wiki/faq/serialization = 'Serialization and Unserialization' -->
<!-- /wiki/faq/class-libraries = 'Class Libraries' -->
<!-- /wiki/faq/compiler-dependencies = 'Compiler Dependencies' -->
<!-- /wiki/faq/misc-technical-issues = 'Miscellaneous Technical Issues' -->
<!-- /wiki/faq/misc-environmental-issues = 'Miscellaneous Environmental Issues' -->
<!-- /wiki/faq/style-and-techniques = 'Miscellaneous Style Issues' -->
<!-- /wiki/faq/user-groups-worldwide = 'User Groups Worldwide' -->
<!-- /wiki/faq/cpp11 = 'C++11 Overview' -->
<!-- /wiki/faq/cpp11-language = 'C++11 Language Extensions --- General Features' -->
<!-- /wiki/faq/cpp11-language-classes = 'C++11 Language Extensions -- Classes' -->
<!-- /wiki/faq/cpp11-language-concurrency = 'C++11 Language Extensions --- Concurrency' -->
<!-- /wiki/faq/cpp11-language-misc = 'C++11 Language Extensions --- Miscellaneous Language Features' -->
<!-- /wiki/faq/cpp11-language-templates = 'C++11 Language Extensions -- Templates' -->
<!-- /wiki/faq/cpp11-language-types = 'C++11 Language Extensions --- Other Types' -->
<!-- /wiki/faq/cpp11-library = 'C++11 Library Extensions --- General Libraries' -->
<!-- /wiki/faq/cpp11-library-concurrency = 'C++11 Standard Library Extensions --- Concurrency' -->
<!-- /wiki/faq/cpp11-library-stl = 'C++11 Standard Library Extensions --- Containers and Algorithms' -->
<!-- /wiki/faq/cpp0x-concepts-history = 'C++0x Concepts --- Historical FAQs' -->
<!-- /wiki/faq/cpp14 = 'C++14 Overview' -->
<!-- /wiki/faq/cpp14-language = 'C++14 Language Extensions' -->
<!-- /wiki/faq/cpp14-library = 'C++14 Library Extensions' -->
<!-- /wiki/faq/wg21 = 'WG21 Members' -->
<!-- /wiki/faq/subject-index = 'Subject Index' --></p>

<!-- BEGIN 'Category' Namespace Stuff -->


<!-- END 'Category' Namespace Stuff -->


<!-- BEGIN Categories for Page -->


<!-- END Categories for Page -->


</div>


          </div>

        </article>

      </div>
      
<div id="popup-suggest" class="wiki-popup">
  <p>Please <a href="../../member/login.html">Login</a> to submit a recommendation.</p>
  <p>If you don&rsquo;t have an account, you can <a href="../../member/register.html">register for free.</a></p>
</div>

        </div>
        
        <div id="root-footer"></div>
      </div>
    </div>

    <footer id="bottom" role="contentinfo">
      <div class="container">
        &copy; <a href="../../home/terms-of-use.html">Copyright</a> 2015 Standard C++ Foundation. 
        All rights reserved. 
        <ul id="nav-sub">
<li class="first"><a href="../../home/terms-of-use.html">Terms of Use</a></li>
<li class="last"><a href="../../home/privacy-policy.html">Privacy Policy</a></li>
</ul>
      </div>
    </footer>

    <script src="../../../ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../javascript/jquery.html"><\/script>')</script>
    <script src="../../../ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/jquery-ui.min.js"></script>
    <script>window.jQuery.ui || document.write('<script src="../../javascript/jquery-ui.html"><\/script>')</script>
    
    <script type="text/javascript" charset="utf-8" src="../../index97fd.html?ACT=comment_editor"></script>
    <script type="text/javascript">
	        					$(document).ready(function() {
									$("*[id^=likee_]").click(function(){
										var ids = $(this).attr("id").split("_");
										if (ids[1]=="c"){
											id=ids[2];
											c="c_";
											isCom="true";
										} else {
											id=ids[1];
											c="";
											isCom="false";
										}
										
										$.ajax({
	   										type: "POST",
	   										url: "/wiki/faq/mixing-c-and-cpp",
	   										data: "likee=true&entry_id="+id+"&isCom="+isCom,
	   										success: function(msg){
	     										//alert( "Data Saved: " + msg );
	   										}
	 									});
	 									
	 									$(this).replaceWith("<strong>"+$(this).html()+"</strong>");
	 									$("#dislikee_"+c+id).replaceWith("<span>"+$("#dislikee_"+c+id).html()+"</span>");
	 									$("#scoreeCount_"+c+id).html(parseInt($("#scoreeCount_"+c+id).html())+1);
	 									$("#likeeCount_"+c+id).html(parseInt($("#likeeCount_"+c+id).html())+1);
	 									$("#likeeReplace_"+c+id).replaceWith("");
	 									$("#likeeShow_"+c+id).replaceWith($("#likeeShow_"+c+id).html());
									});
									
									$("*[id^=dislikee_]").click(function(){
										var ids = $(this).attr("id").split("_");
										if (ids[1]=="c"){
											id=ids[2];
											c="c_";
											isCom="true";
										} else {
											id=ids[1];
											c="";
											isCom="false";
										}
										$.ajax({
	   										type: "POST",
	   										url: "/wiki/faq/mixing-c-and-cpp",
	   										data: "dislikee=true&entry_id="+id+"&isCom="+isCom,
	   										success: function(msg){
	     										//alert( "Data Saved: " + msg );
	   										}
	 									});
	 									
	 									$(this).replaceWith("<strong>"+$(this).html()+"</strong>");
	 									$("#likee_"+c+id).replaceWith("<span>"+$("#likee_"+c+id).html()+"</span>");
	 									$("#scoreeCount_"+c+id).html(parseInt($("#scoreeCount_"+c+id).html())-1);
	 									$("#dislikeeCount_"+c+id).html(parseInt($("#dislikeeCount_"+c+id).html())+1);
	 									$("#likeeReplace_"+c+id).replaceWith("");
	 									$("#likeeShow_"+c+id).replaceWith($("#likeeShow_"+c+id).html());
									});
								
								});	
	        			  </script>
    
    <script type="text/javascript" src="../../js/isocpp.min.js"></script>
    
    <script type="text/javascript" src="../../js/magnific.min.js"></script>
    <script type="text/javascript" src="../../js/qtip.min.js"></script>
    <script type="text/javascript" src="../../themes/wiki_themes/isocpp/javascript/wiki57ff.js?v=20140115"></script>
    
    <script type="text/javascript">
      $("#top nav a").each(function() {
        var aSeg1 = $(this).attr("href").replace("http://", "").replace("https:///", "").split("../../index.html")[1];
        if (aSeg1 == "wiki") {$(this).parent().addClass("here");}
      });
    </script>

  </body>

<!-- Mirrored from isocpp.org/wiki/faq/mixing-c-and-cpp by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 01 Aug 2015 12:41:41 GMT -->
</html>